@(events: List[Event], allProposalsForReview: List[Proposal], totalEvents:Int, page:Int)(implicit lang: Lang, flash: Flash, uuid: String)

@main("CFP Admin") {

    <div class="row">
        <div class="col-lg-offset-4 col-md-4">
            <h2><i class="icon-beaker"></i> CFP Admin</h2>
        </div>
        <div class="clearfix"></div>

        <div class="col-md-12">

            @if(flash.get("error").isDefined) {
                <div class="alert alert-danger alert-dismissable">
                    <strong>Error :</strong>
                    @flash.get("error").get
                </div>
            }
            @if(flash.get("success").isDefined) {
                <div class="alert alert-success alert-dismissable">
                @flash.get("success").get
                </div>
            }

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3><i class="icon-ok-circle"></i> Your todo list </h3>
                </div>
                <div class="panel-body">
                    <a href="@routes.CFPAdmin.leaderBoard()" class="btn btn-sm btn-primary"><i class="icon-trophy"></i> Show leaderboard</a>
                    <a href="@routes.CFPAdmin.allMyVotes()" class="btn btn-sm btn-primary"><i class="icon-bar-chart"></i> All your votes</a>
                    @if(Webuser.isMember(uuid, "admin")){
                        <a href="@routes.Backoffice.allSpeakers" class="btn btn-sm btn-primary"> All speakers</a>
                        <a href="@routes.Backoffice.allDraftProposals" class="btn btn-sm btn-primary"> All DRAFT proposals</a>
                        <a href="@routes.Backoffice.allSubmittedProposals" class="btn btn-sm btn-primary"> All SUBMITTED proposals</a>
                    }
                    @if(allProposalsForReview.nonEmpty) {
                        <table class="table table-bordered table-strippted">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Track</th>
                                    <th>Speaker</th>
                                    <th>Type of talk</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                            @allProposalsForReview.map { proposal: Proposal =>
                                <tr>
                                    <td>
                                        @proposal.title
                                    </td>
                                    <td>
                                    @Messages(proposal.track.label)
                                    </td>
                                    <td>
                                        @tags.renderGravatar(proposal.mainSpeaker)
                                        @proposal.secondarySpeaker.map { sc =>
                                            @tags.renderGravatar(sc)
                                        }
                                        @proposal.otherSpeakers.map { s =>
                                            @tags.renderGravatar(s)
                                        }
                                    </td>
                                    <td>@Messages(proposal.talkType.id)</td>
                                    <td>
                                        <a href="@routes.CFPAdmin.openForReview(proposal.id)" title="Open for review">
                                            Review</a>
                                    </td>
                                </tr>
                            }
                            </tbody>
                        </table>
                    } else {
                        <h4>There is no new talks submitted that you haven't reviewed</h4>
                    }

                </div>
            </div>
        </div>

        <div class="col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3><i class="icon-stackexchange"></i> Recent events</h3>
                </div>



                <div class="panel-body">
                    <table class="table table-bordered table-strippted">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Author</th>
                                <th>Proposal id</th>
                                <th>Message</th>
                            </tr>
                            <tr>
                                <td colspan="4">
                                    <small>
                                    Total events: @totalEvents - Page @page/@(totalEvents/20)
                                    @if(page > 0){
                                      <a href="@routes.CFPAdmin.index(page-1)">&lt; Previous page</a> -
                                    }
                                    @if(page < totalEvents/20){
                                      <a href="@routes.CFPAdmin.index(page+1)">Next page &gt;</a>
                                    }</small>
                                </td>
                            </tr>

                        </thead>
                        <tbody>
                        @events.map { event: Event =>
                            <tr>
                                <td>
                                    <small>@event.date.map(_.toString("dd/MM HH:mm"))</small>
                                </td>
                                <td>
                                @tags.renderGravatar(event.uuid)
                                </td>
                                <td>
                                @tags.renderObjRef(event.objRef)
                                </td>
                                <td><small>@event.msg</small></td>
                            </tr>
                        }
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4">
                                    <small>
                                    Total events: @totalEvents - Page @page/@(totalEvents/20)
                                    @if(page > 0){
                                      <a href="@routes.CFPAdmin.index(page-1)">&lt; Previous page</a> -
                                    }
                                    @if(page < totalEvents/20){
                                      <a href="@routes.CFPAdmin.index(page+1)">Next page &gt;</a>
                                    }
                                    </small>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
}